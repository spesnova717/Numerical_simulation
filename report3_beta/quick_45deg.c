#include <stdio.h>
#include <math.h>
#define N 50
#define M 5

int main(void){
    int i,j,k;
    double u[N+2][N+2][3];
    double theta = 45.0;
    double alpha=theta*M_PI/180.0;
    double dx=1.0/N;
    double dy=1.0/N;

    for(i=0; i<=N+1; i++){
        for(j=0; j<=N+1; j++){
            u[i][j][1] = 0.0;
            u[i][j][2] = 0.0;
        }
    }

    for(i=0; i<=M; i++){
        u[i][0][1] = 1.0;
        u[i][0][2] = 1.0;
        u[i][1][1] = 1.0;
        u[i][1][2] = 1.0;
    }

    for(j=0; j<=M; j++){
        u[0][j][1] = 1.0;
        u[0][j][2] = 1.0;
        u[1][j][1] = 1.0;
        u[1][j][2] = 1.0;
    }

    for(k=1; k<=1000; k++){
        for(i=2; i<=N; i++){
         for(j=2; j<=N; j++){
                   u[i][j][1]=(-cos(alpha)*dy*(3.0*u[i+1][j][2]-7.0*u[i-1][j][2]+u[i-2][j][2])
                    -sin(alpha)*dx*(3.0*u[i][j+1][2]-7.0*u[i][j-1][2]+u[i][j-2][2]))
                    /(3.0*(dy*cos(alpha)+dx*sin(alpha)));
                   u[i][j][2]=0.9*u[i][j][2]+0.1*u[i][j][1];
                   u[j][N+1][2]=u[j][N][2];
                   u[N+1][j][2]=u[N][j][2];
            }
        }
    }

    for(j=0; j<=N; j++){
        printf("%10lf %10lf %10lf %10lf %10lf %10lf %10lf %10lf %10lf %10lf \
                %10lf %10lf %10lf %10lf %10lf %10lf %10lf %10lf %10lf %10lf \
                %10lf %10lf %10lf %10lf %10lf %10lf %10lf %10lf %10lf %10lf \
                %10lf %10lf %10lf %10lf %10lf %10lf %10lf %10lf %10lf %10lf \
                %10lf %10lf %10lf %10lf %10lf %10lf %10lf %10lf %10lf %10lf %10lf\n",
                u[0][j][2],u[1][j][2],u[2][j][2],u[3][j][2],u[4][j][2],u[5][j][2],u[6][j][2],u[7][j][2],u[8][j][2],u[9][j][2],
                u[10][j][2],u[11][j][2],u[12][j][2],u[13][j][2],u[14][j][2],u[15][j][2],u[16][j][2],u[17][j][2],u[18][j][2],u[19][j][2],
                u[20][j][2],u[21][j][2],u[22][j][2],u[23][j][2],u[24][j][2],u[25][j][2],u[26][j][2],u[27][j][2],u[28][j][2],u[29][j][2],
                u[30][j][2],u[31][j][2],u[32][j][2],u[33][j][2],u[34][j][2],u[35][j][2],u[36][j][2],u[37][j][2],u[38][j][2],u[39][j][2],
                u[40][j][2],u[41][j][2],u[42][j][2],u[43][j][2],u[44][j][2],u[45][j][2],u[46][j][2],u[47][j][2],u[48][j][2],u[49][j][2],u[50][j][2]);

    }
}

